# Load the libraries
library(lavaan)
library(semPlot)
head(HolzingerSwineford1939)
cfa_model <- 'visual  =~ x1 + x2 + x3
  textual =~ x4 + x5 + x6
  speed   =~ x7 + x8 + x9'
cfa_model
# Fit CFA model
cfa_fit <- cfa(cfa_model, data = HolzingerSwineford1939)

# Summary with fit indices
summary(cfa_fit, fit.measures = TRUE, standardized = TRUE)

sem_model <- '
  # Measurement part
  visual  =~ x1 + x2 + x3
  textual =~ x4 + x5 + x6
  speed   =~ x7 + x8 + x9

  # Structural part
  speed ~ visual + textual
'

# Fit SEM model
sem_fit <- sem(sem_model, data = HolzingerSwineford1939)

# Summary
summary(sem_fit, fit.measures = TRUE, standardized = TRUE)

fitMeasures(sem_fit, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea", "srmr"))

semPaths(sem_fit, what = "std",layout = "tree", residuals = FALSE)
